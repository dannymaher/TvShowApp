package uk.ac.tees.tvshowapp;

import android.content.Context;

import androidx.room.EmptyResultSetException;
import androidx.room.Room;
import androidx.test.core.app.ApplicationProvider;
import androidx.test.ext.junit.runners.AndroidJUnit4;

import com.google.gson.Gson;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;

import io.reactivex.Single;
import uk.ac.tees.tvshowapp.database.AppDatabase;
import uk.ac.tees.tvshowapp.database.TVShowRepository;
import uk.ac.tees.tvshowapp.database.dto.TVShowData;
import uk.ac.tees.tvshowapp.tmdb.model.Season;
import uk.ac.tees.tvshowapp.tmdb.model.TVShow;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

@RunWith(AndroidJUnit4.class)
public class TestTVShowRepository {
    private AppDatabase database;
    private TVShowRepository tvShowRepository;
    private TVShow exampleShow;
    private Season exampleSeason;

    /**
     * initialise (in memory) test database, film repository and example film.
     */
    @Before
    public void setupDb() {
        Context context = ApplicationProvider.getApplicationContext();
        database = Room.inMemoryDatabaseBuilder(context, AppDatabase.class).build();
        tvShowRepository = new TVShowRepository(database);

        String exampleShowJson = "{\"backdrop_path\":\"/gX8SYlnL9ZznfZwEH4KJUePBFUM.jpg\",\"created_by\":[{\"id\":9813,\"credit_id\":\"5256c8c219c2956ff604858a\",\"name\":\"David Benioff\",\"gender\":2,\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"},{\"id\":228068,\"credit_id\":\"552e611e9251413fea000901\",\"name\":\"D. B. Weiss\",\"gender\":2,\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"}],\"episode_run_time\":[60],\"first_air_date\":\"2011-04-17\",\"genres\":[{\"id\":10765,\"name\":\"Sci-Fi & Fantasy\"},{\"id\":18,\"name\":\"Drama\"},{\"id\":10759,\"name\":\"Action & Adventure\"}],\"homepage\":\"http://www.hbo.com/game-of-thrones\",\"id\":1399,\"in_production\":true,\"languages\":[\"es\",\"en\",\"de\"],\"last_air_date\":\"2017-08-27\",\"last_episode_to_air\":{\"air_date\":\"2017-08-27\",\"episode_number\":7,\"id\":1340528,\"name\":\"The Dragon and the Wolf\",\"overview\":\"A meeting is held in King's Landing. Problems arise in the North.\",\"production_code\":\"707\",\"season_number\":7,\"show_id\":1399,\"still_path\":\"/jLe9VcbGRDUJeuM8IwB7VX4GDRg.jpg\",\"vote_average\":9.145,\"vote_count\":31},\"name\":\"Game of Thrones\",\"next_episode_to_air\":null,\"networks\":[{\"name\":\"HBO\",\"id\":49,\"logo_path\":\"/tuomPhY2UtuPTqqFnKMVHvSb724.png\",\"origin_country\":\"US\"}],\"number_of_episodes\":67,\"number_of_seasons\":7,\"origin_country\":[\"US\"],\"original_language\":\"en\",\"original_name\":\"Game of Thrones\",\"overview\":\"Seven noble families fight for control of the mythical land of Westeros. Friction between the houses leads to full-scale war. All while a very ancient evil awakens in the farthest north. Amidst the war, a neglected military order of misfits, the Night's Watch, is all that stands between the realms of men and icy horrors beyond.\",\"popularity\":53.516,\"poster_path\":\"/gwPSoYUHAKmdyVywgLpKKA4BjRr.jpg\",\"production_companies\":[{\"id\":76043,\"logo_path\":\"/9RO2vbQ67otPrBLXCaC8UMp3Qat.png\",\"name\":\"Revolution Sun Studios\",\"origin_country\":\"US\"},{\"id\":3268,\"logo_path\":\"/tuomPhY2UtuPTqqFnKMVHvSb724.png\",\"name\":\"HBO\",\"origin_country\":\"US\"},{\"id\":12525,\"logo_path\":null,\"name\":\"Television 360\",\"origin_country\":\"\"},{\"id\":5820,\"logo_path\":null,\"name\":\"Generator Entertainment\",\"origin_country\":\"\"},{\"id\":12526,\"logo_path\":null,\"name\":\"Bighead Littlehead\",\"origin_country\":\"\"}],\"seasons\":[{\"air_date\":\"2010-12-05\",\"episode_count\":14,\"id\":3627,\"name\":\"Specials\",\"overview\":\"\",\"poster_path\":\"/kMTcwNRfFKCZ0O2OaBZS0nZ2AIe.jpg\",\"season_number\":0},{\"air_date\":\"2011-04-17\",\"episode_count\":10,\"id\":3624,\"name\":\"Season 1\",\"overview\":\"Trouble is brewing in the Seven Kingdoms of Westeros. For the driven inhabitants of this visionary world, control of Westeros' Iron Throne holds the lure of great power. But in a land where the seasons can last a lifetime, winter is coming...and beyond the Great Wall that protects them, an ancient evil has returned. In Season One, the story centers on three primary areas: the Stark and the Lannister families, whose designs on controlling the throne threaten a tenuous peace; the dragon princess Daenerys, heir to the former dynasty, who waits just over the Narrow Sea with her malevolent brother Viserys; and the Great Wall--a massive barrier of ice where a forgotten danger is stirring.\",\"poster_path\":\"/zwaj4egrhnXOBIit1tyb4Sbt3KP.jpg\",\"season_number\":1},{\"air_date\":\"2012-04-01\",\"episode_count\":10,\"id\":3625,\"name\":\"Season 2\",\"overview\":\"The cold winds of winter are rising in Westeros...war is coming...and five kings continue their savage quest for control of the all-powerful Iron Throne. With winter fast approaching, the coveted Iron Throne is occupied by the cruel Joffrey, counseled by his conniving mother Cersei and uncle Tyrion. But the Lannister hold on the Throne is under assault on many fronts. Meanwhile, a new leader is rising among the wildings outside the Great Wall, adding new perils for Jon Snow and the order of the Night's Watch.\",\"poster_path\":\"/5tuhCkqPOT20XPwwi9NhFnC1g9R.jpg\",\"season_number\":2},{\"air_date\":\"2013-03-31\",\"episode_count\":10,\"id\":3626,\"name\":\"Season 3\",\"overview\":\"Duplicity and treachery...nobility and honor...conquest and triumph...and, of course, dragons. In Season 3, family and loyalty are the overarching themes as many critical storylines from the first two seasons come to a brutal head. Meanwhile, the Lannisters maintain their hold on King's Landing, though stirrings in the North threaten to alter the balance of power; Robb Stark, King of the North, faces a major calamity as he tries to build on his victories; a massive army of wildlings led by Mance Rayder march for the Wall; and Daenerys Targaryen--reunited with her dragons--attempts to raise an army in her quest for the Iron Throne.\",\"poster_path\":\"/qYxRy8ZYCo2yTz7HsO6J1HWtPsY.jpg\",\"season_number\":3},{\"air_date\":\"2014-04-06\",\"episode_count\":10,\"id\":3628,\"name\":\"Season 4\",\"overview\":\"The War of the Five Kings is drawing to a close, but new intrigues and plots are in motion, and the surviving factions must contend with enemies not only outside their ranks, but within.\",\"poster_path\":\"/dniQ7zw3mbLJkd1U0gdFEh4b24O.jpg\",\"season_number\":4},{\"air_date\":\"2015-04-12\",\"episode_count\":10,\"id\":62090,\"name\":\"Season 5\",\"overview\":\"The War of the Five Kings, once thought to be drawing to a close, is instead entering a new and more chaotic phase. Westeros is on the brink of collapse, and many are seizing what they can while the realm implodes, like a corpse making a feast for crows.\",\"poster_path\":\"/527sR9hNDcgVDKNUE3QYra95vP5.jpg\",\"season_number\":5},{\"air_date\":\"2016-04-24\",\"episode_count\":10,\"id\":71881,\"name\":\"Season 6\",\"overview\":\"Following the shocking developments at the conclusion of season five, survivors from all parts of Westeros and Essos regroup to press forward, inexorably, towards their uncertain individual fates. Familiar faces will forge new alliances to bolster their strategic chances at survival, while new characters will emerge to challenge the balance of power in the east, west, north and south.\",\"poster_path\":\"/zvYrzLMfPIenxoq2jFY4eExbRv8.jpg\",\"season_number\":6},{\"air_date\":\"2017-07-16\",\"episode_count\":7,\"id\":81266,\"name\":\"Season 7\",\"overview\":\"The long winter is here. And with it comes a convergence of armies and attitudes that have been brewing for years.\",\"poster_path\":\"/3dqzU3F3dZpAripEx9kRnijXbOj.jpg\",\"season_number\":7}],\"status\":\"Returning Series\",\"type\":\"Scripted\",\"vote_average\":8.2,\"vote_count\":4682}";
        exampleShow = new Gson().fromJson(exampleShowJson, TVShow.class);

        String exampleSeasonJson = "{\"_id\":\"5256c89f19c2956ff6046d47\",\"air_date\":\"2011-04-17\",\"episodes\":[{\"air_date\":\"2011-04-17\",\"crew\":[{\"id\":44797,\"credit_id\":\"5256c8a219c2956ff6046e77\",\"name\":\"Tim Van Patten\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":\"/6b7l9YbkDHDOzOKUFNqBVaPjcgm.jpg\"},{\"id\":1318704,\"credit_id\":\"54eef2429251417974005cb6\",\"name\":\"Alik Sakharov\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":\"/50ZlHkh66aOPxQMjQ21LJDAkYlR.jpg\"},{\"id\":18077,\"credit_id\":\"54eef2ab925141795f005d4f\",\"name\":\"Oral Norrie Ottey\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"}],\"episode_number\":1,\"guest_stars\":[{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"},{\"id\":946696,\"name\":\"Ian Whyte\",\"credit_id\":\"5750cd459251412b0f000224\",\"character\":\"White Walker\",\"order\":46,\"profile_path\":\"/6mRY7hTtHfDTGuTLmZmODOu9buF.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":1833,\"name\":\"Jamie Sives\",\"credit_id\":\"5752136f9251414c510001a0\",\"character\":\"Jory Cassel\",\"order\":55,\"profile_path\":\"/92BcXrr2W7gZri6xVlLhpLLaPsf.jpg\"},{\"id\":234907,\"name\":\"Dar Salim\",\"credit_id\":\"5752158b9251414c470001c0\",\"character\":\"Qotho\",\"order\":56,\"profile_path\":\"/3CrPTwZJ0hsWzX7oi7sKFfzDo82.jpg\"},{\"id\":11279,\"name\":\"Roger Allam\",\"credit_id\":\"575216bdc3a36851fe0001d8\",\"character\":\"Illyrio Mopatis\",\"order\":57,\"profile_path\":\"/gr59GfVZz9QV6jZyHKOsKCBxXPr.jpg\"},{\"id\":1600544,\"name\":\"Aimee Richardson\",\"credit_id\":\"57521d4cc3a3685215000344\",\"character\":\"Myrcella Baratheon\",\"order\":60,\"profile_path\":\"/r53KnAfLiR8NaK3Kp2Nu4q0KSoP.jpg\"},{\"id\":1600543,\"name\":\"Callum Wharry\",\"credit_id\":\"57521fafc3a368521500041d\",\"character\":\"Tommen Baratheon\",\"order\":61,\"profile_path\":\"/rVaMQfGwylZWWM2eRJ3qAEkS0tK.jpg\"}],\"name\":\"Winter Is Coming\",\"overview\":\"Jon Arryn, the Hand of the King, is dead. King Robert Baratheon plans to ask his oldest friend, Eddard Stark, to take Jon's place. Across the sea, Viserys Targaryen plans to wed his sister to a nomadic warlord in exchange for an army.\",\"id\":63056,\"production_code\":\"101\",\"season_number\":1,\"still_path\":\"/wrGWeW4WKxnaeA8sxJb2T9O6ryo.jpg\",\"vote_average\":7.11904761904762,\"vote_count\":21},{\"air_date\":\"2011-04-24\",\"crew\":[{\"id\":44797,\"credit_id\":\"5256c8a219c2956ff6046e77\",\"name\":\"Tim Van Patten\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":\"/6b7l9YbkDHDOzOKUFNqBVaPjcgm.jpg\"},{\"id\":1318704,\"credit_id\":\"54eef2429251417974005cb6\",\"name\":\"Alik Sakharov\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":\"/50ZlHkh66aOPxQMjQ21LJDAkYlR.jpg\"},{\"id\":18077,\"credit_id\":\"54eef2ab925141795f005d4f\",\"name\":\"Oral Norrie Ottey\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"}],\"episode_number\":2,\"guest_stars\":[{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"},{\"id\":225870,\"name\":\"Wilko Johnson\",\"credit_id\":\"5750d240c3a3682fa000041c\",\"character\":\"Ilyn Payne\",\"order\":49,\"profile_path\":\"/ofncvvhuucP8ip3x8duQEzhJrsT.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":228969,\"name\":\"Roxanne McKee\",\"credit_id\":\"57520a4ac3a368520c0000aa\",\"character\":\"Doreah\",\"order\":51,\"profile_path\":\"/oJYawHvbZM48lNTGWKATapFzplL.jpg\"},{\"id\":1833,\"name\":\"Jamie Sives\",\"credit_id\":\"5752136f9251414c510001a0\",\"character\":\"Jory Cassel\",\"order\":55,\"profile_path\":\"/92BcXrr2W7gZri6xVlLhpLLaPsf.jpg\"},{\"id\":234907,\"name\":\"Dar Salim\",\"credit_id\":\"5752158b9251414c470001c0\",\"character\":\"Qotho\",\"order\":56,\"profile_path\":\"/3CrPTwZJ0hsWzX7oi7sKFfzDo82.jpg\"},{\"id\":1600546,\"name\":\"Luke Barnes\",\"credit_id\":\"57521aa7c3a3685204000294\",\"character\":\"Rast\",\"order\":59,\"profile_path\":\"/s9WIklN7aqPJMnun0oxoO4QFb3C.jpg\"},{\"id\":1600544,\"name\":\"Aimee Richardson\",\"credit_id\":\"57521d4cc3a3685215000344\",\"character\":\"Myrcella Baratheon\",\"order\":60,\"profile_path\":\"/r53KnAfLiR8NaK3Kp2Nu4q0KSoP.jpg\"},{\"id\":1600543,\"name\":\"Callum Wharry\",\"credit_id\":\"57521fafc3a368521500041d\",\"character\":\"Tommen Baratheon\",\"order\":61,\"profile_path\":\"/rVaMQfGwylZWWM2eRJ3qAEkS0tK.jpg\"}],\"name\":\"The Kingsroad\",\"overview\":\"While Bran recovers from his fall, Ned takes only his daughters to Kings Landing. Jon Snow goes with his uncle Benjen to The Wall. Tyrion joins them.\",\"id\":63057,\"production_code\":\"102\",\"season_number\":1,\"still_path\":\"/icjOgl5F9DhysOEo6Six2Qfwcu2.jpg\",\"vote_average\":7.375,\"vote_count\":4},{\"air_date\":\"2011-05-01\",\"crew\":[{\"id\":93223,\"credit_id\":\"5256c8a219c2956ff6046f0b\",\"name\":\"Brian Kirk\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":null},{\"id\":59984,\"credit_id\":\"54eef41d9251417971005b8d\",\"name\":\"Marco Pontecorvo\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":null},{\"id\":1204180,\"credit_id\":\"54eef453c3a3680b80006153\",\"name\":\"Frances Parker\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"}],\"episode_number\":3,\"guest_stars\":[{\"id\":386,\"name\":\"Peter Vaughan\",\"credit_id\":\"57617dd692514156c2000046\",\"character\":\"Maester Aemon\",\"order\":63,\"profile_path\":\"/z9ZplbTA1ojYhgZ8kJUKKhsJ7Gs.jpg\"},{\"id\":1600546,\"name\":\"Luke Barnes\",\"credit_id\":\"57521aa7c3a3685204000294\",\"character\":\"Rast\",\"order\":59,\"profile_path\":\"/s9WIklN7aqPJMnun0oxoO4QFb3C.jpg\"},{\"id\":1833,\"name\":\"Jamie Sives\",\"credit_id\":\"5752136f9251414c510001a0\",\"character\":\"Jory Cassel\",\"order\":55,\"profile_path\":\"/92BcXrr2W7gZri6xVlLhpLLaPsf.jpg\"},{\"id\":58654,\"name\":\"Owen Teale\",\"credit_id\":\"5752114a9251414c5400013c\",\"character\":\"Alliser Thorne\",\"order\":54,\"profile_path\":\"/cUxG0sgqNJXuRAbOCKsAqFLyRDi.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":39661,\"name\":\"Francis Magee\",\"credit_id\":\"5750d0ddc3a36818f1000489\",\"character\":\"Yoren\",\"order\":48,\"profile_path\":\"/aHW0KktJ4u7MqeZ0ii11OkH3EIY.jpg\"},{\"id\":1399527,\"name\":\"Miltos Yerolemou\",\"credit_id\":\"5750cf9a9251412b790002bb\",\"character\":\"Syrio Forel\",\"order\":47,\"profile_path\":\"/iw0hivfHyuDLFPeLqWcbc9KNt7G.jpg\"},{\"id\":43554,\"name\":\"Josef Altin\",\"credit_id\":\"5750c9f6c3a3682fa0000129\",\"character\":\"Pypar\",\"order\":43,\"profile_path\":\"/lnr6IQUAyXP0y1oj7sEZgmNpzpL.jpg\"},{\"id\":1345950,\"name\":\"Mark Stanley\",\"credit_id\":\"5750c8009251412b79000045\",\"character\":\"Grenn\",\"order\":42,\"profile_path\":\"/y6Z9tXUxNRay8MEo2ZQPtXQJ05m.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"}],\"name\":\"Lord Snow\",\"overview\":\"Lord Stark and his daughters arrive at King's Landing to discover the intrigues of the king's realm.\",\"id\":63058,\"production_code\":\"103\",\"season_number\":1,\"still_path\":\"/4vCYVtIhiYSUry1lviA7CKPUB5Z.jpg\",\"vote_average\":6.875,\"vote_count\":4},{\"air_date\":\"2011-05-08\",\"crew\":[{\"id\":93223,\"credit_id\":\"5256c8a219c2956ff6046f0b\",\"name\":\"Brian Kirk\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":null},{\"id\":59984,\"credit_id\":\"54eef41d9251417971005b8d\",\"name\":\"Marco Pontecorvo\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":null},{\"id\":1204180,\"credit_id\":\"54eef453c3a3680b80006153\",\"name\":\"Frances Parker\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":1223784,\"credit_id\":\"5256c8a419c2956ff6046f62\",\"name\":\"Bryan Cogman\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":null}],\"episode_number\":4,\"guest_stars\":[{\"id\":1600543,\"name\":\"Callum Wharry\",\"credit_id\":\"57521fafc3a368521500041d\",\"character\":\"Tommen Baratheon\",\"order\":61,\"profile_path\":\"/rVaMQfGwylZWWM2eRJ3qAEkS0tK.jpg\"},{\"id\":1600544,\"name\":\"Aimee Richardson\",\"credit_id\":\"57521d4cc3a3685215000344\",\"character\":\"Myrcella Baratheon\",\"order\":60,\"profile_path\":\"/r53KnAfLiR8NaK3Kp2Nu4q0KSoP.jpg\"},{\"id\":1600546,\"name\":\"Luke Barnes\",\"credit_id\":\"57521aa7c3a3685204000294\",\"character\":\"Rast\",\"order\":59,\"profile_path\":\"/s9WIklN7aqPJMnun0oxoO4QFb3C.jpg\"},{\"id\":1833,\"name\":\"Jamie Sives\",\"credit_id\":\"5752136f9251414c510001a0\",\"character\":\"Jory Cassel\",\"order\":55,\"profile_path\":\"/92BcXrr2W7gZri6xVlLhpLLaPsf.jpg\"},{\"id\":58654,\"name\":\"Owen Teale\",\"credit_id\":\"5752114a9251414c5400013c\",\"character\":\"Alliser Thorne\",\"order\":54,\"profile_path\":\"/cUxG0sgqNJXuRAbOCKsAqFLyRDi.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":228969,\"name\":\"Roxanne McKee\",\"credit_id\":\"57520a4ac3a368520c0000aa\",\"character\":\"Doreah\",\"order\":51,\"profile_path\":\"/oJYawHvbZM48lNTGWKATapFzplL.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":39661,\"name\":\"Francis Magee\",\"credit_id\":\"5750d0ddc3a36818f1000489\",\"character\":\"Yoren\",\"order\":48,\"profile_path\":\"/aHW0KktJ4u7MqeZ0ii11OkH3EIY.jpg\"},{\"id\":127453,\"name\":\"Conan Stevens\",\"credit_id\":\"5750cc09c3a368018b0004b2\",\"character\":\"Gregor Clegane\",\"order\":44,\"profile_path\":\"/8mlrCTSXDInF15w6CO4IYgbPKg7.jpg\"},{\"id\":43554,\"name\":\"Josef Altin\",\"credit_id\":\"5750c9f6c3a3682fa0000129\",\"character\":\"Pypar\",\"order\":43,\"profile_path\":\"/lnr6IQUAyXP0y1oj7sEZgmNpzpL.jpg\"},{\"id\":1345950,\"name\":\"Mark Stanley\",\"credit_id\":\"5750c8009251412b79000045\",\"character\":\"Grenn\",\"order\":42,\"profile_path\":\"/y6Z9tXUxNRay8MEo2ZQPtXQJ05m.jpg\"},{\"id\":193335,\"name\":\"Dominic Carter\",\"credit_id\":\"556b676592514173e0003e18\",\"character\":\"Janos Slynt\",\"order\":10,\"profile_path\":\"/8Wu34kgPhGI00XnQlt3OOmZepHL.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"}],\"name\":\"Cripples, Bastards, and Broken Things\",\"overview\":\"Eddard investigates Jon Arryn's murder. Jon befriends Samwell Tarly, a coward who has come to join the Night's Watch.\",\"id\":63059,\"production_code\":\"104\",\"season_number\":1,\"still_path\":\"/a4tO7cgpv9IkatqAsv5k20zzlyi.jpg\",\"vote_average\":8.3,\"vote_count\":5},{\"air_date\":\"2011-05-15\",\"crew\":[{\"id\":93223,\"credit_id\":\"5256c8a219c2956ff6046f0b\",\"name\":\"Brian Kirk\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":null},{\"id\":59984,\"credit_id\":\"54eef41d9251417971005b8d\",\"name\":\"Marco Pontecorvo\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":null},{\"id\":1204180,\"credit_id\":\"54eef453c3a3680b80006153\",\"name\":\"Frances Parker\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"}],\"episode_number\":5,\"guest_stars\":[{\"id\":1014926,\"name\":\"Lino Facioli\",\"credit_id\":\"5750c267c3a36818f1000138\",\"character\":\"Robin Arryn\",\"order\":40,\"profile_path\":\"/5OqKQqQBBu8TAEkw5y3rMlvKoS9.jpg\"},{\"id\":127453,\"name\":\"Conan Stevens\",\"credit_id\":\"5750cc09c3a368018b0004b2\",\"character\":\"Gregor Clegane\",\"order\":44,\"profile_path\":\"/8mlrCTSXDInF15w6CO4IYgbPKg7.jpg\"},{\"id\":39661,\"name\":\"Francis Magee\",\"credit_id\":\"5750d0ddc3a36818f1000489\",\"character\":\"Yoren\",\"order\":48,\"profile_path\":\"/aHW0KktJ4u7MqeZ0ii11OkH3EIY.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":1833,\"name\":\"Jamie Sives\",\"credit_id\":\"5752136f9251414c510001a0\",\"character\":\"Jory Cassel\",\"order\":55,\"profile_path\":\"/92BcXrr2W7gZri6xVlLhpLLaPsf.jpg\"},{\"id\":11279,\"name\":\"Roger Allam\",\"credit_id\":\"575216bdc3a36851fe0001d8\",\"character\":\"Illyrio Mopatis\",\"order\":57,\"profile_path\":\"/gr59GfVZz9QV6jZyHKOsKCBxXPr.jpg\"},{\"id\":1600544,\"name\":\"Aimee Richardson\",\"credit_id\":\"57521d4cc3a3685215000344\",\"character\":\"Myrcella Baratheon\",\"order\":60,\"profile_path\":\"/r53KnAfLiR8NaK3Kp2Nu4q0KSoP.jpg\"},{\"id\":1600543,\"name\":\"Callum Wharry\",\"credit_id\":\"57521fafc3a368521500041d\",\"character\":\"Tommen Baratheon\",\"order\":61,\"profile_path\":\"/rVaMQfGwylZWWM2eRJ3qAEkS0tK.jpg\"}],\"name\":\"The Wolf and the Lion\",\"overview\":\"Catelyn has captured Tyrion and plans to bring him to her sister, Lysa Arryn, at The Vale, to be tried for his, supposed, crimes against Bran. Robert plans to have Daenerys killed, but Eddard refuses to be a part of it and quits.\",\"id\":63060,\"production_code\":\"105\",\"season_number\":1,\"still_path\":\"/qS3CHz3AKaC6WhlxQuEXPdrEPjg.jpg\",\"vote_average\":7.25,\"vote_count\":4},{\"air_date\":\"2011-05-22\",\"crew\":[{\"id\":77213,\"credit_id\":\"5256c8a519c2956ff604706c\",\"name\":\"Jane Espenson\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/kWXT8SGenskyFM65v5IByXqOHOp.jpg\"},{\"id\":88743,\"credit_id\":\"5256c8a519c2956ff60470ac\",\"name\":\"Daniel Minahan\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":null},{\"id\":94545,\"credit_id\":\"54eef670c3a3686d5e005571\",\"name\":\"Matthew Jensen\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":null},{\"id\":81827,\"credit_id\":\"54eef67cc3a3680b80006196\",\"name\":\"Martin Nicholson\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"}],\"episode_number\":6,\"guest_stars\":[{\"id\":3300,\"name\":\"Natalia Tena\",\"credit_id\":\"5256c8a519c2956ff6046ff6\",\"character\":\"\",\"order\":0,\"profile_path\":\"/A5977qcPr05zAQSqr7nKKSbJhpY.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"},{\"id\":740,\"name\":\"Julian Glover\",\"credit_id\":\"5256c8a519c2956ff6047046\",\"character\":\"\",\"order\":1,\"profile_path\":\"/2sQWrB4of8O2k7DGwJ3OdGJi2Mj.jpg\"},{\"id\":1014926,\"name\":\"Lino Facioli\",\"credit_id\":\"5750c267c3a36818f1000138\",\"character\":\"Robin Arryn\",\"order\":40,\"profile_path\":\"/5OqKQqQBBu8TAEkw5y3rMlvKoS9.jpg\"},{\"id\":1399527,\"name\":\"Miltos Yerolemou\",\"credit_id\":\"5750cf9a9251412b790002bb\",\"character\":\"Syrio Forel\",\"order\":47,\"profile_path\":\"/iw0hivfHyuDLFPeLqWcbc9KNt7G.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":228969,\"name\":\"Roxanne McKee\",\"credit_id\":\"57520a4ac3a368520c0000aa\",\"character\":\"Doreah\",\"order\":51,\"profile_path\":\"/oJYawHvbZM48lNTGWKATapFzplL.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":234907,\"name\":\"Dar Salim\",\"credit_id\":\"5752158b9251414c470001c0\",\"character\":\"Qotho\",\"order\":56,\"profile_path\":\"/3CrPTwZJ0hsWzX7oi7sKFfzDo82.jpg\"}],\"name\":\"A Golden Crown\",\"overview\":\"While recovering from his battle with Jamie, Eddard is forced to run the kingdom while Robert goes hunting. Tyrion demands a trial by combat for his freedom. Viserys is losing his patience with Drogo.\",\"id\":63061,\"production_code\":\"106\",\"season_number\":1,\"still_path\":\"/AqtTrDIHKB6USFUUxLiIWJ6LTes.jpg\",\"vote_average\":6.375,\"vote_count\":4},{\"air_date\":\"2011-05-29\",\"crew\":[{\"id\":88743,\"credit_id\":\"5256c8a519c2956ff60470ac\",\"name\":\"Daniel Minahan\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":null},{\"id\":94545,\"credit_id\":\"54eef670c3a3686d5e005571\",\"name\":\"Matthew Jensen\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":null},{\"id\":81827,\"credit_id\":\"54eef67cc3a3680b80006196\",\"name\":\"Martin Nicholson\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"}],\"episode_number\":7,\"guest_stars\":[{\"id\":386,\"name\":\"Peter Vaughan\",\"credit_id\":\"57617dd692514156c2000046\",\"character\":\"Maester Aemon\",\"order\":63,\"profile_path\":\"/z9ZplbTA1ojYhgZ8kJUKKhsJ7Gs.jpg\"},{\"id\":1600546,\"name\":\"Luke Barnes\",\"credit_id\":\"57521aa7c3a3685204000294\",\"character\":\"Rast\",\"order\":59,\"profile_path\":\"/s9WIklN7aqPJMnun0oxoO4QFb3C.jpg\"},{\"id\":234907,\"name\":\"Dar Salim\",\"credit_id\":\"5752158b9251414c470001c0\",\"character\":\"Qotho\",\"order\":56,\"profile_path\":\"/3CrPTwZJ0hsWzX7oi7sKFfzDo82.jpg\"},{\"id\":58654,\"name\":\"Owen Teale\",\"credit_id\":\"5752114a9251414c5400013c\",\"character\":\"Alliser Thorne\",\"order\":54,\"profile_path\":\"/cUxG0sgqNJXuRAbOCKsAqFLyRDi.jpg\"},{\"id\":228969,\"name\":\"Roxanne McKee\",\"credit_id\":\"57520a4ac3a368520c0000aa\",\"character\":\"Doreah\",\"order\":51,\"profile_path\":\"/oJYawHvbZM48lNTGWKATapFzplL.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":43554,\"name\":\"Josef Altin\",\"credit_id\":\"5750c9f6c3a3682fa0000129\",\"character\":\"Pypar\",\"order\":43,\"profile_path\":\"/lnr6IQUAyXP0y1oj7sEZgmNpzpL.jpg\"},{\"id\":1345950,\"name\":\"Mark Stanley\",\"credit_id\":\"5750c8009251412b79000045\",\"character\":\"Grenn\",\"order\":42,\"profile_path\":\"/y6Z9tXUxNRay8MEo2ZQPtXQJ05m.jpg\"},{\"id\":193335,\"name\":\"Dominic Carter\",\"credit_id\":\"556b676592514173e0003e18\",\"character\":\"Janos Slynt\",\"order\":10,\"profile_path\":\"/8Wu34kgPhGI00XnQlt3OOmZepHL.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"},{\"id\":3300,\"name\":\"Natalia Tena\",\"credit_id\":\"5256c8a519c2956ff6046ff6\",\"character\":\"\",\"order\":0,\"profile_path\":\"/A5977qcPr05zAQSqr7nKKSbJhpY.jpg\"}],\"name\":\"You Win or You Die\",\"overview\":\"Robert has been injured while hunting and is dying. Jon and the others finally take their vows to the Night's Watch. A man, sent by Robert, is captured for trying to poison Daenerys. Furious, Drogo vows to attack the Seven Kingdoms.\",\"id\":63062,\"production_code\":\"107\",\"season_number\":1,\"still_path\":\"/l0d3WVs99QZPoxrOGuk21mV5NSp.jpg\",\"vote_average\":8.125,\"vote_count\":4},{\"air_date\":\"2011-06-05\",\"crew\":[{\"id\":88743,\"credit_id\":\"5256c8a519c2956ff60470ac\",\"name\":\"Daniel Minahan\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":null},{\"id\":94545,\"credit_id\":\"54eef670c3a3686d5e005571\",\"name\":\"Matthew Jensen\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":null},{\"id\":81827,\"credit_id\":\"54eef67cc3a3680b80006196\",\"name\":\"Martin Nicholson\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":237053,\"credit_id\":\"5256c8a619c2956ff60471bc\",\"name\":\"George R. R. Martin\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/v1fA3LZ4DefEPUvSFZmJVmczUmv.jpg\"}],\"episode_number\":8,\"guest_stars\":[{\"id\":1600546,\"name\":\"Luke Barnes\",\"credit_id\":\"57521aa7c3a3685204000294\",\"character\":\"Rast\",\"order\":59,\"profile_path\":\"/s9WIklN7aqPJMnun0oxoO4QFb3C.jpg\"},{\"id\":234907,\"name\":\"Dar Salim\",\"credit_id\":\"5752158b9251414c470001c0\",\"character\":\"Qotho\",\"order\":56,\"profile_path\":\"/3CrPTwZJ0hsWzX7oi7sKFfzDo82.jpg\"},{\"id\":58654,\"name\":\"Owen Teale\",\"credit_id\":\"5752114a9251414c5400013c\",\"character\":\"Alliser Thorne\",\"order\":54,\"profile_path\":\"/cUxG0sgqNJXuRAbOCKsAqFLyRDi.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":228969,\"name\":\"Roxanne McKee\",\"credit_id\":\"57520a4ac3a368520c0000aa\",\"character\":\"Doreah\",\"order\":51,\"profile_path\":\"/oJYawHvbZM48lNTGWKATapFzplL.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":1399527,\"name\":\"Miltos Yerolemou\",\"credit_id\":\"5750cf9a9251412b790002bb\",\"character\":\"Syrio Forel\",\"order\":47,\"profile_path\":\"/iw0hivfHyuDLFPeLqWcbc9KNt7G.jpg\"},{\"id\":43554,\"name\":\"Josef Altin\",\"credit_id\":\"5750c9f6c3a3682fa0000129\",\"character\":\"Pypar\",\"order\":43,\"profile_path\":\"/lnr6IQUAyXP0y1oj7sEZgmNpzpL.jpg\"},{\"id\":1345950,\"name\":\"Mark Stanley\",\"credit_id\":\"5750c8009251412b79000045\",\"character\":\"Grenn\",\"order\":42,\"profile_path\":\"/y6Z9tXUxNRay8MEo2ZQPtXQJ05m.jpg\"},{\"id\":1403284,\"name\":\"Ian Beattie\",\"credit_id\":\"5750c4e3c3a36801920002ac\",\"character\":\"Meryn Trant\",\"order\":41,\"profile_path\":\"/aK2HzSykgu0bX2INEdgC6x0BKR3.jpg\"},{\"id\":193335,\"name\":\"Dominic Carter\",\"credit_id\":\"556b676592514173e0003e18\",\"character\":\"Janos Slynt\",\"order\":10,\"profile_path\":\"/8Wu34kgPhGI00XnQlt3OOmZepHL.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"},{\"id\":3300,\"name\":\"Natalia Tena\",\"credit_id\":\"5256c8a519c2956ff6046ff6\",\"character\":\"\",\"order\":0,\"profile_path\":\"/A5977qcPr05zAQSqr7nKKSbJhpY.jpg\"}],\"name\":\"The Pointy End\",\"overview\":\"Eddard and his men are betrayed and captured by the Lannisters. When word reaches Robb, he plans to go to war to rescue them. The White Walkers attack The Wall. Tyrion returns to his father with some new friends.\",\"id\":63063,\"production_code\":\"108\",\"season_number\":1,\"still_path\":\"/9ZvT1IZPcC11eiCByOzqQvC3CCR.jpg\",\"vote_average\":7,\"vote_count\":4},{\"air_date\":\"2011-06-12\",\"crew\":[{\"id\":1318704,\"credit_id\":\"54eef2429251417974005cb6\",\"name\":\"Alik Sakharov\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":\"/50ZlHkh66aOPxQMjQ21LJDAkYlR.jpg\"},{\"id\":47005,\"credit_id\":\"5256c8a619c2956ff6047255\",\"name\":\"Alan Taylor\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":\"/f8hPlHuaRw1py22wp2qqNRfVDMw.jpg\"},{\"id\":1204180,\"credit_id\":\"54eef453c3a3680b80006153\",\"name\":\"Frances Parker\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"}],\"episode_number\":9,\"guest_stars\":[{\"id\":386,\"name\":\"Peter Vaughan\",\"credit_id\":\"57617dd692514156c2000046\",\"character\":\"Maester Aemon\",\"order\":63,\"profile_path\":\"/z9ZplbTA1ojYhgZ8kJUKKhsJ7Gs.jpg\"},{\"id\":1600546,\"name\":\"Luke Barnes\",\"credit_id\":\"57521aa7c3a3685204000294\",\"character\":\"Rast\",\"order\":59,\"profile_path\":\"/s9WIklN7aqPJMnun0oxoO4QFb3C.jpg\"},{\"id\":234907,\"name\":\"Dar Salim\",\"credit_id\":\"5752158b9251414c470001c0\",\"character\":\"Qotho\",\"order\":56,\"profile_path\":\"/3CrPTwZJ0hsWzX7oi7sKFfzDo82.jpg\"},{\"id\":228969,\"name\":\"Roxanne McKee\",\"credit_id\":\"57520a4ac3a368520c0000aa\",\"character\":\"Doreah\",\"order\":51,\"profile_path\":\"/oJYawHvbZM48lNTGWKATapFzplL.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":225870,\"name\":\"Wilko Johnson\",\"credit_id\":\"5750d240c3a3682fa000041c\",\"character\":\"Ilyn Payne\",\"order\":49,\"profile_path\":\"/ofncvvhuucP8ip3x8duQEzhJrsT.jpg\"},{\"id\":39661,\"name\":\"Francis Magee\",\"credit_id\":\"5750d0ddc3a36818f1000489\",\"character\":\"Yoren\",\"order\":48,\"profile_path\":\"/aHW0KktJ4u7MqeZ0ii11OkH3EIY.jpg\"},{\"id\":43554,\"name\":\"Josef Altin\",\"credit_id\":\"5750c9f6c3a3682fa0000129\",\"character\":\"Pypar\",\"order\":43,\"profile_path\":\"/lnr6IQUAyXP0y1oj7sEZgmNpzpL.jpg\"},{\"id\":1345950,\"name\":\"Mark Stanley\",\"credit_id\":\"5750c8009251412b79000045\",\"character\":\"Grenn\",\"order\":42,\"profile_path\":\"/y6Z9tXUxNRay8MEo2ZQPtXQJ05m.jpg\"},{\"id\":11180,\"name\":\"David Bradley\",\"credit_id\":\"574e6088c3a3680134001206\",\"character\":\"Lord Walder Frey\",\"order\":36,\"profile_path\":\"/5BPFRv4io7U1zxkYHtKaE9a8FDD.jpg\"},{\"id\":193335,\"name\":\"Dominic Carter\",\"credit_id\":\"556b676592514173e0003e18\",\"character\":\"Janos Slynt\",\"order\":10,\"profile_path\":\"/8Wu34kgPhGI00XnQlt3OOmZepHL.jpg\"},{\"id\":740,\"name\":\"Julian Glover\",\"credit_id\":\"5256c8a519c2956ff6047046\",\"character\":\"\",\"order\":1,\"profile_path\":\"/2sQWrB4of8O2k7DGwJ3OdGJi2Mj.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"}],\"name\":\"Baelor\",\"overview\":\"Robb goes to war against the Lannisters. Jon finds himself struggling on deciding if his place is with Robb or the Night's Watch. Drogo has fallen ill from a fresh battle wound. Daenerys is desperate to save him.\",\"id\":63064,\"production_code\":\"109\",\"season_number\":1,\"still_path\":\"/41zQhAxoccalbhcd1udPIPJVTt1.jpg\",\"vote_average\":8.1,\"vote_count\":5},{\"air_date\":\"2011-06-19\",\"crew\":[{\"id\":1318704,\"credit_id\":\"54eef2429251417974005cb6\",\"name\":\"Alik Sakharov\",\"department\":\"Camera\",\"job\":\"Director of Photography\",\"profile_path\":\"/50ZlHkh66aOPxQMjQ21LJDAkYlR.jpg\"},{\"id\":47005,\"credit_id\":\"5256c8a619c2956ff6047255\",\"name\":\"Alan Taylor\",\"department\":\"Directing\",\"job\":\"Director\",\"profile_path\":\"/f8hPlHuaRw1py22wp2qqNRfVDMw.jpg\"},{\"id\":1204180,\"credit_id\":\"54eef453c3a3680b80006153\",\"name\":\"Frances Parker\",\"department\":\"Editing\",\"job\":\"Editor\",\"profile_path\":null},{\"id\":228068,\"credit_id\":\"5256c8a219c2956ff6046e4b\",\"name\":\"D. B. Weiss\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/caUAtilEe06OwOjoQY3B7BgpARi.jpg\"},{\"id\":9813,\"credit_id\":\"5256c8a019c2956ff6046e2b\",\"name\":\"David Benioff\",\"department\":\"Writing\",\"job\":\"Writer\",\"profile_path\":\"/8CuuNIKMzMUL1NKOPv9AqEwM7og.jpg\"}],\"episode_number\":10,\"guest_stars\":[{\"id\":1600547,\"name\":\"Ben Hawkey\",\"credit_id\":\"575217419251414c570001cd\",\"character\":\"Hot Pie\",\"order\":58,\"profile_path\":\"/qiK3Aa5UQxh9H6ul8rdD1Io9xxA.jpg\"},{\"id\":438859,\"name\":\"Susan Brown\",\"credit_id\":\"57520bc19251414c470000de\",\"character\":\"Septa Mordane\",\"order\":52,\"profile_path\":\"/5bYvoJDOw4okAzSxJ1avXweUyA9.jpg\"},{\"id\":1048692,\"name\":\"Amrita Acharia\",\"credit_id\":\"5750d365925141087f0006e1\",\"character\":\"Irri\",\"order\":50,\"profile_path\":\"/uwz4vjtIMxD9y7uq3CFpPjrznVR.jpg\"},{\"id\":225870,\"name\":\"Wilko Johnson\",\"credit_id\":\"5750d240c3a3682fa000041c\",\"character\":\"Ilyn Payne\",\"order\":49,\"profile_path\":\"/ofncvvhuucP8ip3x8duQEzhJrsT.jpg\"},{\"id\":39661,\"name\":\"Francis Magee\",\"credit_id\":\"5750d0ddc3a36818f1000489\",\"character\":\"Yoren\",\"order\":48,\"profile_path\":\"/aHW0KktJ4u7MqeZ0ii11OkH3EIY.jpg\"},{\"id\":43554,\"name\":\"Josef Altin\",\"credit_id\":\"5750c9f6c3a3682fa0000129\",\"character\":\"Pypar\",\"order\":43,\"profile_path\":\"/lnr6IQUAyXP0y1oj7sEZgmNpzpL.jpg\"},{\"id\":1345950,\"name\":\"Mark Stanley\",\"credit_id\":\"5750c8009251412b79000045\",\"character\":\"Grenn\",\"order\":42,\"profile_path\":\"/y6Z9tXUxNRay8MEo2ZQPtXQJ05m.jpg\"},{\"id\":1403284,\"name\":\"Ian Beattie\",\"credit_id\":\"5750c4e3c3a36801920002ac\",\"character\":\"Meryn Trant\",\"order\":41,\"profile_path\":\"/aK2HzSykgu0bX2INEdgC6x0BKR3.jpg\"},{\"id\":5118,\"name\":\"Sibel Kekilli\",\"credit_id\":\"5256c8b919c2956ff6048330\",\"character\":\"Shae\",\"order\":16,\"profile_path\":\"/4E0wtNJ2WiBtvHXur0uursQ7HLl.jpg\"},{\"id\":117642,\"name\":\"Jason Momoa\",\"credit_id\":\"5256c8a219c2956ff6046f40\",\"character\":\"Khal Drogo\",\"order\":0,\"profile_path\":\"/PSK6GmsVwdhqz9cd1lwzC6a7EA.jpg\"},{\"id\":3300,\"name\":\"Natalia Tena\",\"credit_id\":\"5256c8a519c2956ff6046ff6\",\"character\":\"\",\"order\":0,\"profile_path\":\"/A5977qcPr05zAQSqr7nKKSbJhpY.jpg\"}],\"name\":\"Fire and Blood\",\"overview\":\"With Ned dead, Robb vows to get revenge on the Lannisters. Jon must officially decide if his place is with Robb or the Night's Watch. Daenerys says her final goodbye to Drogo.\",\"id\":63065,\"production_code\":\"110\",\"season_number\":1,\"still_path\":\"/88loh1qyi8vwJO8qH1SdQRsHKNI.jpg\",\"vote_average\":8.08333333333333,\"vote_count\":6}],\"name\":\"Season 1\",\"overview\":\"Trouble is brewing in the Seven Kingdoms of Westeros. For the driven inhabitants of this visionary world, control of Westeros' Iron Throne holds the lure of great power. But in a land where the seasons can last a lifetime, winter is coming...and beyond the Great Wall that protects them, an ancient evil has returned. In Season One, the story centers on three primary areas: the Stark and the Lannister families, whose designs on controlling the throne threaten a tenuous peace; the dragon princess Daenerys, heir to the former dynasty, who waits just over the Narrow Sea with her malevolent brother Viserys; and the Great Wall--a massive barrier of ice where a forgotten danger is stirring.\",\"id\":3624,\"poster_path\":\"/olJ6ivXxCMq3cfujo1IRw30OrsQ.jpg\",\"season_number\":1}";
        exampleSeason = new Gson().fromJson(exampleSeasonJson, Season.class);
    }

    /**
     * test tv show data is stored correctly
     */
    @Test
    public void putTVShow_newShow_dataCorrect() {
        // insert example film
        tvShowRepository.putTVShowSync(exampleShow);

        // get dto
        TVShowData showData = database.tvShowDao().get(exampleShow.getId()).blockingGet().tvShow;

        // check data is correct
        assertEquals(exampleShow.getId().intValue(), showData.tvShowId);
        assertEquals(exampleShow.getBackdropPath(), showData.backdropPath);
        assertEquals(exampleShow.getFirstAirDate(), showData.firstAirDate);
        assertEquals(exampleShow.getHomepage(), showData.homepage);
        assertEquals(exampleShow.getInProduction(), showData.inProduction);
        assertEquals(exampleShow.getLastAirDate(), showData.lastAirDate);
        assertEquals(exampleShow.getName(), showData.name);
        assertEquals(exampleShow.getNumberOfEpisodes(), showData.numberOfEpisodes);
        assertEquals(exampleShow.getNumberOfSeasons(), showData.numberOfSeasons);
        assertEquals(exampleShow.getOriginalLanguage(), showData.originalLanguage);
        assertEquals(exampleShow.getOriginalName(), showData.originalName);
        assertEquals(exampleShow.getOverview(), showData.overview);
        assertEquals(exampleShow.getPopularity(), showData.popularity);
        assertEquals(exampleShow.getPosterPath(), showData.posterPath);
        assertEquals(exampleShow.getStatus(), showData.status);
        assertEquals(exampleShow.getType(), showData.type);
        assertEquals(exampleShow.getVoteAverage(), showData.voteAverage);
        assertEquals(exampleShow.getVoteCount(), showData.voteCount);
    }

    /**
     * test tv show genres are correct
     */
    @Test
    public void putTVShow_newShow_genresCorrect() {
        TVShow tvShow = putThenGetShow();

        assertTrue(exampleShow.getGenres().containsAll(tvShow.getGenres()));
        assertTrue(tvShow.getGenres().containsAll(exampleShow.getGenres()));
    }

    /**
     * test tv show last episode is correct
     */
    @Test
    public void putTVShow_newShow_lastEpisodeCorrect() {
        TVShow tvShow = putThenGetShow();

        assertEquals(exampleShow.getLastEpisodeToAir(), tvShow.getLastEpisodeToAir());
    }

    /**
     * test tv show seasons are correct
     */
    @Test
    public void putTVShow_newShow_seasonsCorrect() {
        TVShow tvShow = putThenGetShow();

        assertEquals(exampleShow.getSeasons(), tvShow.getSeasons());
    }

    /**
     * test season data is stored correctly
     */
    @Test
    public void putSeason_existingSeason_dataCorrect() {
        TVShow tvShow = putThenGetShow();

        tvShowRepository.putSeasonSync(tvShow.getId(), exampleSeason);
        Season season = tvShowRepository.getSeason(tvShow.getId(), exampleSeason.getSeasonNumber()).blockingGet();

        assertEquals(exampleSeason, season);
    }

    /**
     * test the tvshow data is deleted correctly
     */
    @Test(expected = EmptyResultSetException.class)
    public void deleteShow_showDeleted() {
        putThenGetShow();
        tvShowRepository.deleteTVShowSync(exampleShow.getId());

        // should throw empty results exception
        Single<TVShow> filmSingle = tvShowRepository.getTvShow(exampleShow.getId());
        TVShow tvShow = filmSingle.blockingGet();
    }

    /**
     * test the seasons are deleted with the tv show
     */
    @Test(expected = EmptyResultSetException.class)
    public void deleteShow_seasonsDeleted() {
        putThenGetShow();
        tvShowRepository.deleteTVShowSync(exampleShow.getId());

        // should throw empty results exception
        Single<Season> seasonSingle = tvShowRepository.getSeason(exampleShow.getId(), exampleSeason.getSeasonNumber());
        Season season = seasonSingle.blockingGet();
    }

    /**
     * insert example film into the database then retreive it
     *
     * @return the film from the database
     */
    private TVShow putThenGetShow() {
        // insert example film
        tvShowRepository.putTVShowSync(exampleShow);

        // get the inserted film
        Single<TVShow> filmSingle = tvShowRepository.getTvShow(exampleShow.getId());
        return filmSingle.blockingGet();
    }
}
